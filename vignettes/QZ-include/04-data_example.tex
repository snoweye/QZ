
\section[Data Example]{Data Example}
\label{sec:data_example}
\addcontentsline{toc}{section}{\thesection. Data Example}

There are four demos for the \pkg{QZ} package which are listed in
Table~\ref{tab:demo_QZ}
\begin{table}[h!tb]
\begin{center}
\caption{The demos of \pkg{QZ} package.}
\label{tab:demo_QZ}
\begin{tabular}{l|l} \hline \hline
\code{demo}           & Purpose \\ \hline
\code{ex1_geigen}     & \code{geigen()} for double/complex single/paired matrices \\
\code{ex2_qz}         & \code{qz()} for double/complex single/paired matrices \\
\code{ex3_ordqz}      & \code{ordqz()} and arbiturary reordering \\
\code{ex4_fda_geigen} & generalized eigen analysis of \pkg{fda} pacakge~\citep{fda} \\
\hline\hline
\end{tabular}
\end{center}
\end{table}

There are also several datasets for \pkg{QZ} package to verify results which
are listed in Table~\ref{tab:data_QZ}.
\begin{table}[h!tb]
\begin{center}
\caption{The datasets of \pkg{QZ} package.}
\label{tab:data_QZ}
\begin{tabular}{l|l} \hline \hline
\code{data}           & Source \\ \hline
\code{exAB1} & \url{https://www.nag.com/lapack-ex/node124.html} \\
\code{exAB2} & \url{https://www.nag.com/lapack-ex/node119.html} \\
\code{exAB3} & \url{https://www.nag.com/numeric/fl/nagdoc_fl23/xhtml/f08/f08yuf.xml} \\
\code{exAB4} & \url{https://www.nag.com/numeric/fl/nagdoc_fl23/xhtml/f08/f08yuf.xml} \\ \hline
\code{exA1}  & \url{https://www.nag.com/lapack-ex/node94.html} \\
\code{exA2}  & \url{https://www.nag.com/lapack-ex/node89.html} \\
\code{exA3}  & \url{https://www.nag.com/numeric/fl/nagdoc_fl23/xhtml/f08/f08quf.xml} \\
\code{exA4}  & \url{https://www.nag.com/numeric/fl/nagdoc_fl22/xhtml/f08/f08quf.xml} \\
\hline\hline
\end{tabular}
\end{center}
\end{table}

These demos can be obtained in \proglang{R} by the following.
\begin{Code}[title=QZ demo ex1\_geigen]
> demo(ex1_geigen, 'QZ')


	demo(ex1_geigen)
	---- ~~~~~~~~~~

Type  <Return>	 to start : 

> library(QZ, quiet = TRUE)

> ### https://www.nag.com/lapack-ex/node122.html
> (ret <- geigen(exAB1$A, exAB1$B))
ALPHA:
[1] 19.03-57.10i 11.88-29.70i 10.96- 3.65i 21.87-27.34i

BETA:
[1] 6.344+0i 5.941+0i 3.654+0i 5.468+0i

U:
                [,1]            [,2]            [,3]              [,4]
[1,]  0.0358-0.1155i  0.0725-0.3001i  0.1650-0.0068i  0.01727-0.02542i
[2,]  0.2152+0.2357i -0.2139+0.7641i  0.0999-0.8330i -0.01045-0.09180i
[3,] -0.2425+0.4271i  0.7520-0.2317i -0.9374-0.0626i -0.17518-0.82482i
[4,]  0.5658-0.4342i -0.1782-0.8218i -0.0529+0.1385i -0.84361-0.01589i

V:
                [,1]               [,2]           [,3]               [,4]
[1,] -0.8238-0.1762i  0.63974+0.360259i 0.9775+0.0225i -0.90623+0.093766i
[2,] -0.1530+0.0707i  0.00416-0.000547i 0.1591-0.1137i -0.00743+0.006875i
[3,] -0.0707-0.1530i  0.04021+0.022645i 0.1209-0.1537i  0.03021-0.003126i
[4,]  0.1530-0.0707i -0.02264+0.040212i 0.1537+0.1209i -0.01459-0.140970i

> ### https://www.nag.com/lapack-ex/node117.html
> (ret <- geigen(exAB2$A, exAB2$B))
ALPHA:
[1] 3.801+0.000i 3.030+4.040i 1.563-2.084i 4.000+0.000i

BETA:
[1] 1.900 1.010 0.521 1.000

U:
            [,1]            [,2]            [,3]          [,4]
[1,]  0.53333+0i  0.2171-0.1284i  0.2171+0.1284i -7.276e-17+0i
[2,] -0.06667+0i  0.1744-0.1851i  0.1744+0.1851i -1.000e+00+0i
[3,] -1.00000+0i -0.7928+0.2072i -0.7928-0.2072i  1.000e+00+0i
[4,]  0.60000+0i  0.3912+0.0911i  0.3912-0.0911i -3.695e-16+0i

V:
            [,1]            [,2]            [,3]        [,4]
[1,] 1.000000+0i -0.4398-0.5602i -0.4398+0.5602i -1.00000+0i
[2,] 0.005714+0i -0.0880-0.1120i -0.0880+0.1120i -0.01111+0i
[3,] 0.062857+0i -0.1424+0.0031i -0.1424-0.0031i  0.03333+0i
[4,] 0.062857+0i -0.1424+0.0031i -0.1424-0.0031i -0.15556+0i

> ### https://www.nag.com/lapack-ex/node92.html
> (ret <- geigen(exA1$A))
W:
[1] -6.000-7.000i -5.000+2.006i  7.998-0.996i  3.002-4.000i

U:
                [,1]            [,2]            [,3]           [,4]
[1,]  0.8357+0.0000i -0.3510+0.1013i -0.1689+0.2595i 0.1099-0.2007i
[2,] -0.0794+0.3372i -0.4035+0.4540i  0.6762+0.0000i 0.0336+0.2312i
[3,]  0.0917+0.3097i  0.6239+0.0000i  0.3032+0.5642i 0.0944-0.3947i
[4,]  0.0456-0.2741i -0.0816-0.3190i  0.1328+0.1376i 0.8534+0.0000i

V:
                [,1]            [,2]            [,3]            [,4]
[1,]  0.8457+0.0000i -0.3865+0.1732i -0.1730+0.2669i -0.0356-0.1782i
[2,] -0.0177+0.3036i -0.3539+0.4529i  0.6924+0.0000i  0.1264+0.2666i
[3,]  0.0875+0.3115i  0.6124+0.0000i  0.3324+0.4960i  0.0129-0.2966i
[4,] -0.0561-0.2906i -0.0859-0.3284i  0.2504-0.0147i  0.8898+0.0000i

> ### https://www.nag.com/lapack-ex/node87.html
> (ret <- geigen(exA2$A))
W:
[1]  0.7995+0.0000i -0.0994+0.4008i -0.0994-0.4008i -0.1007+0.0000i

U:
            [,1]            [,2]            [,3]       [,4]
[1,] -0.62447+0i  0.5330+0.0000i  0.5330+0.0000i  0.6641+0i
[2,] -0.59949+0i -0.2666+0.4041i -0.2666-0.4041i -0.1068+0i
[3,]  0.49992+0i  0.3455+0.3153i  0.3455-0.3153i  0.7293+0i
[4,] -0.02709+0i -0.2541-0.4451i -0.2541+0.4451i  0.1249+0i

V:
            [,1]            [,2]            [,3]      [,4]
[1,] -0.65509+0i -0.1933+0.2546i -0.1933-0.2546i 0.1253+0i
[2,] -0.52363+0i  0.2519-0.5224i  0.2519+0.5224i 0.3320+0i
[3,]  0.53622+0i  0.0972-0.3084i  0.0972+0.3084i 0.5938+0i
[4,] -0.09561+0i  0.6760+0.0000i  0.6760+0.0000i 0.7221+0i
\end{Code}


\begin{Code}[title=QZ demo ex2\_qz]
> demo(ex2_qz, 'QZ')


	demo(ex2_qz)
	---- ~~~~~~

Type  <Return>	 to start : 

> library(QZ, quiet = TRUE)

> ### https://www.nag.com/lapack-ex/node124.html
> (ret <- qz(exAB1$A, exAB1$B))
ALPHA:
[1] 19.03-57.10i 11.88-29.70i 10.96- 3.65i 21.87-27.34i

BETA:
[1] 6.344+0i 5.941+0i 3.654+0i 5.468+0i
S:
            [,1]         [,2]          [,3]          [,4]
[1,] 19.03-57.1i 53.59-89.82i -81.31-63.23i 106.66-44.79i
[2,]  0.00+ 0.0i 11.88-29.70i   3.56+27.63i  -0.67-16.42i
[3,]  0.00+ 0.0i  0.00+ 0.00i  10.96- 3.65i -25.02- 8.20i
[4,]  0.00+ 0.0i  0.00+ 0.00i   0.00+ 0.00i  21.87-27.34i

T:
         [,1]         [,2]          [,3]          [,4]
[1,] 6.344+0i 3.399+0.712i -0.515-2.382i  6.582+2.430i
[2,] 0.000+0i 5.941+0.000i -2.448-0.343i  5.739-0.702i
[3,] 0.000+0i 0.000+0.000i  3.654+0.000i -1.410-3.933i
[4,] 0.000+0i 0.000+0.000i  0.000+0.000i  5.468+0.000i

Q:
                [,1]            [,2]            [,3]              [,4]
[1,] -0.3347+0.7387i  0.2872-0.4789i  0.1725+0.0093i  0.01443-0.02124i
[2,] -0.1277+0.2493i -0.0282+0.4999i  0.1541-0.8008i -0.00873-0.07670i
[3,] -0.3557+0.0396i -0.4615-0.0822i -0.3939+0.0258i -0.14637-0.68917i
[4,] -0.0126-0.3682i  0.1508-0.4417i  0.1517-0.3555i -0.70486-0.01328i

Z:
                [,1]            [,2]              [,3]                  [,4]
[1,] -0.9240-0.1977i  0.2460+0.2090i -0.00543+0.05421i  0.000e+00+0.000e+00i
[2,] -0.1716+0.0793i -0.5943+0.0905i  0.74673-0.21271i -1.092e-16-3.690e-16i
[3,] -0.0793-0.1716i  0.0943-0.5082i  0.01020-0.44383i  7.034e-01-7.277e-02i
[4,]  0.1716-0.0793i  0.5082+0.0943i  0.44383+0.01020i -7.277e-02-7.034e-01i

> ### https://www.nag.com/lapack-ex/node119.html
> (ret <- qz(exAB2$A, exAB2$B))
ALPHA:
[1] 3.801+0.000i 3.030+4.040i 1.563-2.084i 4.000+0.000i

BETA:
[1] 1.900 1.010 0.521 1.000
S:
      [,1]   [,2]    [,3]    [,4]
[1,] 3.801 31.326 -61.485 -66.836
[2,] 0.000  3.351   7.074   6.692
[3,] 0.000 -1.192   1.410   4.379
[4,] 0.000  0.000   0.000   4.000

T:
     [,1]   [,2]    [,3]   [,4]
[1,]  1.9 -1.078 -5.6252 -9.987
[2,]  0.0  1.176  0.0000  1.751
[3,]  0.0  0.000  0.4474  1.090
[4,]  0.0  0.000  0.0000  1.000

Q:
       [,1]     [,2]    [,3]       [,4]
[1,] 0.4642  0.81159  0.3547 -5.145e-17
[2,] 0.5002 -0.06975 -0.4950 -7.071e-01
[3,] 0.5002 -0.06975 -0.4950  7.071e-01
[4,] 0.5331 -0.57585  0.6198 -2.613e-16

Z:
         [,1]     [,2]     [,3]       [,4]
[1,] 0.996056  0.08183 -0.03428  0.000e+00
[2,] 0.005692 -0.44454 -0.89574  5.145e-17
[3,] 0.062609 -0.63075  0.31343  7.071e-01
[4,] 0.062609 -0.63075  0.31343 -7.071e-01

> ### https://www.nag.com/lapack-ex/node94.html
> (ret <- qz(exA1$A))
W:
[1] -6.000-7.000i -5.000+2.006i  7.998-0.996i  3.002-4.000i

T:
      [,1]            [,2]           [,3]            [,4]
[1,] -6-7i  0.1618+0.4896i 0.4761-0.1946i  0.8633-0.3014i
[2,]  0+0i -5.0000+2.0060i 0.6907+0.2115i  0.2281+0.1328i
[3,]  0+0i  0.0000+0.0000i 7.9982-0.9964i -1.0155+0.3626i
[4,]  0+0i  0.0000+0.0000i 0.0000+0.0000i  3.0023-3.9998i

Q:
                [,1]            [,2]            [,3]            [,4]
[1,] -0.5312-0.6581i -0.0799-0.3774i -0.0935-0.2736i  0.1869-0.1321i
[2,]  0.2474-0.1769i -0.4108-0.4021i -0.4015+0.6010i -0.0713+0.2225i
[3,]  0.1874-0.2637i -0.0937+0.6241i -0.5752-0.0389i  0.2581-0.3132i
[4,] -0.1909+0.2262i  0.3457-0.0537i -0.1537+0.1951i  0.7668+0.3747i

> ### https://www.nag.com/lapack-ex/node89.html
> (ret <- qz(exA2$A))
W:
[1]  0.7995+0.0000i -0.0994+0.4008i -0.0994-0.4008i -0.1007+0.0000i

T:
       [,1]      [,2]     [,3]     [,4]
[1,] 0.7995  0.006037 -0.11445 -0.03357
[2,] 0.0000 -0.099412 -0.64834 -0.20258
[3,] 0.0000  0.247764 -0.09941 -0.34742
[4,] 0.0000  0.000000  0.00000 -0.10066

Q:
         [,1]    [,2]    [,3]    [,4]
[1,] -0.65509 -0.3450 -0.1037  0.6641
[2,] -0.52363  0.6141  0.5807 -0.1068
[3,]  0.53622  0.2935  0.3073  0.7293
[4,] -0.09561  0.6463 -0.7467  0.1249
\end{Code}


\begin{Code}[title=QZ demo ex3\_ordqz]
> demo(ex3_ordqz, 'QZ')


	demo(ex3_ordqz)
	---- ~~~~~~~~~

Type  <Return>	 to start : 

> # Reordering eigenvalues
> library(QZ, quiet = TRUE)

> select <- c(TRUE, FALSE, FALSE, TRUE)

> (ret <- qz(exAB1$A, exAB1$B, select = select))
ALPHA:
[1] 19.033-57.099i 17.897-22.371i 18.175-45.437i  8.757- 2.919i

BETA:
[1] 6.344+0i 4.474+0i 9.087+0i 2.919+0i

S:
            [,1]         [,2]             [,3]            [,4]
[1,] 19.03-57.1i  0.07-93.12i -128.250- 6.366i -98.392+ 9.509i
[2,]  0.00+ 0.0i 17.90-22.37i    0.581- 4.575i   6.972+17.755i
[3,]  0.00+ 0.0i  0.00+ 0.00i   18.175-45.437i -19.992- 6.063i
[4,]  0.00+ 0.0i  0.00+ 0.00i    0.000+ 0.000i   8.757- 2.919i

T:
         [,1]         [,2]          [,3]          [,4]
[1,] 6.344+0i 1.427-1.821i -4.137-6.323i -1.783-1.262i
[2,] 0.000+0i 4.474+0.000i -0.003-3.720i -2.992-0.076i
[3,] 0.000+0i 0.000+0.000i  9.087+0.000i -0.777-1.003i
[4,] 0.000+0i 0.000+0.000i  0.000+0.000i  2.919+0.000i

Q:
                [,1]            [,2]            [,3]              [,4]
[1,] -0.3347+0.7387i  0.0511-0.3524i -0.2997+0.3302i  0.08899-0.09359i
[2,] -0.1277+0.2493i  0.3749+0.5365i  0.2504+0.0137i -0.39709-0.52213i
[3,] -0.3557+0.0396i -0.4717+0.2407i  0.0591+0.2199i -0.56045+0.47485i
[4,] -0.0126-0.3682i  0.4020-0.0522i  0.1201+0.8198i  0.04567+0.10657i

Z:
                [,1]            [,2]              [,3]             [,4]
[1,] -0.9240-0.1977i  0.2234+0.1906i -0.08922-0.09991i  0.0338+0.04268i
[2,] -0.1716+0.0793i -0.5288+0.0772i  0.27684-0.00803i  0.3880-0.67191i
[3,] -0.0793-0.1716i -0.1722-0.6151i -0.57435-0.20679i -0.2753-0.32832i
[4,]  0.1716-0.0793i  0.3215+0.3418i -0.58658+0.43433i  0.3229-0.32726i

> ### https://www.nag.com/lapack-ex/node119.html
> select <- c(TRUE, FALSE, FALSE, TRUE)

> (ret <- qz(exAB2$A, exAB2$B, select = select))
ALPHA:
[1] 3.801+0.000i 9.203+0.000i 0.857+1.143i 0.857-1.143i

BETA:
[1] 1.9005 2.3008 0.2857 0.2857

S:
      [,1]    [,2]    [,3]    [,4]
[1,] 3.801 -69.451 50.3135 -43.288
[2,] 0.000   9.203 -0.2001   5.988
[3,] 0.000   0.000  1.4279   4.445
[4,] 0.000   0.000  0.9019  -1.196

T:
     [,1]    [,2]   [,3]    [,4]
[1,]  1.9 -10.228 0.8658 -5.2134
[2,]  0.0   2.301 0.7915  0.4262
[3,]  0.0   0.000 0.8101  0.0000
[4,]  0.0   0.000 0.0000 -0.2823

Q:
       [,1]     [,2]     [,3]    [,4]
[1,] 0.4642  0.78862  0.29148 -0.2786
[2,] 0.5002 -0.59864  0.56379 -0.2713
[3,] 0.5002  0.01541 -0.01074  0.8657
[4,] 0.5331 -0.13952 -0.77270 -0.3151

Z:
         [,1]     [,2]     [,3]      [,4]
[1,] 0.996056 -0.00140  0.08868 -0.002602
[2,] 0.005692 -0.04037 -0.09376 -0.994760
[3,] 0.062609  0.71938 -0.69084  0.036273
[4,] 0.062609 -0.69344 -0.71140  0.095554

> (ret <- ordqz(exAB2$A, exAB2$B, keyword = "ref"))
ALPHA:
[1] 3.801+0.000i 9.203+0.000i 0.857+1.143i 0.857-1.143i

BETA:
[1] 1.9005 2.3008 0.2857 0.2857

S:
      [,1]    [,2]    [,3]    [,4]
[1,] 3.801 -69.451 50.3135 -43.288
[2,] 0.000   9.203 -0.2001   5.988
[3,] 0.000   0.000  1.4279   4.445
[4,] 0.000   0.000  0.9019  -1.196

T:
     [,1]    [,2]   [,3]    [,4]
[1,]  1.9 -10.228 0.8658 -5.2134
[2,]  0.0   2.301 0.7915  0.4262
[3,]  0.0   0.000 0.8101  0.0000
[4,]  0.0   0.000 0.0000 -0.2823

Q:
       [,1]     [,2]     [,3]    [,4]
[1,] 0.4642  0.78862  0.29148 -0.2786
[2,] 0.5002 -0.59864  0.56379 -0.2713
[3,] 0.5002  0.01541 -0.01074  0.8657
[4,] 0.5331 -0.13952 -0.77270 -0.3151

Z:
         [,1]     [,2]     [,3]      [,4]
[1,] 0.996056 -0.00140  0.08868 -0.002602
[2,] 0.005692 -0.04037 -0.09376 -0.994760
[3,] 0.062609  0.71938 -0.69084  0.036273
[4,] 0.062609 -0.69344 -0.71140  0.095554

> (ret <- ordqz(exAB2$A, exAB2$B, keyword = "cef"))
ALPHA:
[1] 0.8571+1.143i 0.8571-1.143i 0.6172+0.000i 4.0000+0.000i

BETA:
[1] 0.2857 0.2857 0.3086 1.0000

S:
        [,1]   [,2]     [,3]    [,4]
[1,] -38.566 41.488  37.2809  65.427
[2,]   6.827 -5.244 -12.9545 -15.482
[3,]   0.000  0.000   0.6172   3.252
[4,]   0.000  0.000   0.0000   4.000

T:
       [,1]   [,2]    [,3]   [,4]
[1,] -3.368 0.0000  4.9228  9.696
[2,]  0.000 0.9621 -1.1839 -2.988
[3,]  0.000 0.0000  0.3086  1.027
[4,]  0.000 0.0000  0.0000  1.000

Q:
        [,1]     [,2]    [,3]       [,4]
[1,] -0.5521 -0.67876  0.4842 -5.145e-17
[2,] -0.5106  0.06994 -0.4842 -7.071e-01
[3,] -0.5106  0.06994 -0.4842  7.071e-01
[4,] -0.4169  0.72767  0.5447 -2.613e-16

Z:
        [,1]    [,2]       [,3]       [,4]
[1,]  0.8775 0.43756  1.961e-01  0.000e+00
[2,]  0.1755 0.08751 -9.806e-01  5.145e-17
[3,] -0.3155 0.63281 -2.387e-15  7.071e-01
[4,] -0.3155 0.63281 -2.498e-15 -7.071e-01

> select <- c(TRUE, FALSE, FALSE, TRUE)

> (ret <- qz(exA1$A, select = select))
W:
[1] -6.000-7.000i  3.002-4.000i -5.000+2.006i  7.998-0.996i

T:
      [,1]           [,2]            [,3]            [,4]
[1,] -6-7i 0.3254-0.8854i  0.5349-0.0829i  0.0083+0.4285i
[2,]  0+0i 3.0023-3.9998i  0.1669+0.2948i -0.2477-1.0389i
[3,]  0+0i 0.0000+0.0000i -5.0000+2.0060i -0.5188-0.4792i
[4,]  0+0i 0.0000+0.0000i  0.0000+0.0000i  7.9982-0.9964i

Q:
                [,1]            [,2]            [,3]            [,4]
[1,] -0.5312-0.6581i -0.0184-0.2122i -0.3775+0.0311i  0.3003+0.0754i
[2,]  0.2474-0.1769i  0.2150+0.2457i -0.4610+0.3622i -0.2198-0.6395i
[3,]  0.1874-0.2637i -0.0469-0.2699i  0.6166+0.1728i  0.4350-0.4701i
[4,] -0.1909+0.2262i  0.8352-0.2747i -0.0033-0.3207i  0.0869-0.1703i

> ### https://www.nag.com/lapack-ex/node89.html
> select <- c(TRUE, FALSE, FALSE, TRUE)

> (ret <- qz(exA2$A, select = select))
W:
[1]  0.7995+0.0000i -0.1007+0.0000i -0.0994+0.4008i -0.0994-0.4008i

T:
       [,1]      [,2]     [,3]     [,4]
[1,] 0.7995 -0.005914 -0.07508 -0.09268
[2,] 0.0000 -0.100657  0.39367  0.35692
[3,] 0.0000  0.000000 -0.09941 -0.51282
[4,] 0.0000  0.000000  0.31324 -0.09941

Q:
         [,1]    [,2]     [,3]     [,4]
[1,] -0.65509 -0.1210 -0.50323  0.55043
[2,] -0.52363 -0.3286  0.78570  0.02287
[3,]  0.53622 -0.5974  0.09038  0.58945
[4,] -0.09561 -0.7215 -0.34825 -0.59081

> (ret <- ordqz(exA2$A, keyword = "lhp"))
W:
[1] -0.0994+0.4008i -0.0994-0.4008i -0.1007+0.0000i  0.7995+0.0000i

T:
         [,1]     [,2]    [,3]     [,4]
[1,] -0.09941  0.24919  0.3491 0.089393
[2,] -0.64462 -0.09941  0.2049 0.090443
[3,]  0.00000  0.00000 -0.1007 0.009467
[4,]  0.00000  0.00000  0.0000 0.799482

Q:
        [,1]    [,2]    [,3]     [,4]
[1,] -0.1733 -0.3607 -0.6707 -0.62447
[2,]  0.5173  0.6024  0.1005 -0.59949
[3,]  0.3629  0.3067 -0.7241  0.49992
[4,] -0.7554  0.6426 -0.1252 -0.02709

> (ret <- ordqz(exA2$A, keyword = "rhp"))
W:
[1]  0.7995+0.0000i -0.0994+0.4008i -0.0994-0.4008i -0.1007+0.0000i

T:
       [,1]      [,2]     [,3]     [,4]
[1,] 0.7995  0.006037 -0.11445 -0.03357
[2,] 0.0000 -0.099412 -0.64834 -0.20258
[3,] 0.0000  0.247764 -0.09941 -0.34742
[4,] 0.0000  0.000000  0.00000 -0.10066

Q:
         [,1]    [,2]    [,3]    [,4]
[1,] -0.65509 -0.3450 -0.1037  0.6641
[2,] -0.52363  0.6141  0.5807 -0.1068
[3,]  0.53622  0.2935  0.3073  0.7293
[4,] -0.09561  0.6463 -0.7467  0.1249

> (ret <- ordqz(exA2$A, keyword = "ref"))
W:
[1]  0.7995+0.0000i -0.1007+0.0000i -0.0994+0.4008i -0.0994-0.4008i

T:
       [,1]      [,2]     [,3]     [,4]
[1,] 0.7995 -0.005914 -0.07508 -0.09268
[2,] 0.0000 -0.100657  0.39367  0.35692
[3,] 0.0000  0.000000 -0.09941 -0.51282
[4,] 0.0000  0.000000  0.31324 -0.09941

Q:
         [,1]    [,2]     [,3]     [,4]
[1,] -0.65509 -0.1210 -0.50323  0.55043
[2,] -0.52363 -0.3286  0.78570  0.02287
[3,]  0.53622 -0.5974  0.09038  0.58945
[4,] -0.09561 -0.7215 -0.34825 -0.59081

> (ret <- ordqz(exA2$A, keyword = "cef"))
W:
[1] -0.0994+0.4008i -0.0994-0.4008i  0.7995+0.0000i -0.1007+0.0000i

T:
         [,1]     [,2]    [,3]      [,4]
[1,] -0.09941  0.24919 0.09306 -0.348147
[2,] -0.64462 -0.09941 0.09259 -0.203889
[3,]  0.00000  0.00000 0.79948  0.009467
[4,]  0.00000  0.00000 0.00000 -0.100657

Q:
        [,1]    [,2]    [,3]    [,4]
[1,] -0.1733 -0.3607 -0.6315  0.6641
[2,]  0.5173  0.6024 -0.5984 -0.1068
[3,]  0.3629  0.3067  0.4923  0.7293
[4,] -0.7554  0.6426 -0.0284  0.1249
\end{Code}


\begin{Code}[title=QZ demo ex4\_fda\_geigen]
> demo(ex4_fda_geigen, 'QZ')


	demo(ex4_fda_geigen)
	---- ~~~~~~~~~~~~~~

Type  <Return>	 to start : 

> library(QZ, quiet = TRUE)

> ### Generate Data
> set.seed(123)

> X <- matrix(rnorm(500), nrow = 25)

> X <- t(X) %*% X

> A <- X[1:8, 9:20]

> B <- X[1:8, 1:8]

> C <- X[9:20, 9:20]

> ### Perform generalized eigenanalysis 
> ret.qz <- fda.geigen(A, B, C)

> ret.fda <- fda::geigen(A, B, C)

> ### Verify
> round(abs(ret.qz$values - ret.fda$values))
[1] 0 0 0 0 0 0 0 0

> round(abs(ret.qz$Lmat - ret.fda$Lmat))
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
[1,]    0    0    0    0    0    0    0    0
[2,]    0    0    0    0    0    0    0    0
[3,]    0    0    0    0    0    0    0    0
[4,]    0    0    0    0    0    0    0    0
[5,]    0    0    0    0    0    0    0    0
[6,]    0    0    0    0    0    0    0    0
[7,]    0    0    0    0    0    0    0    0
[8,]    0    0    0    0    0    0    0    0

> round(abs(ret.qz$Mmat - ret.fda$Mmat))
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
 [1,]    0    0    0    0    0    0    0    0
 [2,]    0    0    0    0    0    0    0    0
 [3,]    0    0    0    0    0    0    0    0
 [4,]    0    0    0    0    0    0    0    0
 [5,]    0    0    0    0    0    0    0    0
 [6,]    0    0    0    0    0    0    0    0
 [7,]    0    0    0    0    0    0    0    0
 [8,]    0    0    0    0    0    0    0    0
 [9,]    0    0    0    0    0    0    0    0
[10,]    0    0    0    0    0    0    0    0
[11,]    0    0    0    0    0    0    0    0
[12,]    0    0    0    0    0    0    0    0
\end{Code}

